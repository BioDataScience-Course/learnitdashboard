#' std_progression UI Function
#'
#' @description A shiny Module.
#'
#' @param id,input,output,session Internal parameters for {shiny}.
#'
#' @noRd 
#'
#' @importFrom shiny NS tagList 
mod_std_progression_ui <- function(id){
  ns <- NS(id)
  tagList(
    
    # uiOutput to display the progression of the selected student
    uiOutput(ns("stdp_progression"))
    
  )
}
    
#' std_progression Server Functions
#'
#' @noRd 
mod_std_progression_server <- function(id, all_vars){
  moduleServer( id, function(input, output, session){
    ns <- session$ns
    
# Getting Modules Vars ----------------------------------------------------
    
    # Vars from right_sidebar
    selected_user <- reactive({all_vars$right_sidebar_vars$selected_user})
    
# Display Progression -----------------------------------------------------

    # Display the progression of selected student or message if all selected
    output$stdp_progression <- renderUI({
      req(selected_user())
      # Message if nothing selected
      if (selected_user() == "All" || selected_user() == "NULL") {
        tagList(
          # Dashboard box
          box( title = "Graph :", status = "primary", solidHeader = TRUE, width = 8,
            tags$h4("Nothing to display, please select a login.")
          )
        )
      # Progression if login selected
      } else if (selected_user() != "All" && selected_user() != "NULL") {
        tagList(
          # Dashboard box
          box( title = paste0("Graph : ", selected_user()), status = "primary", solidHeader = TRUE, width = 8,
            plotOutput(ns("test_graph"))
          )
        )
      }
    })
    
    # Display test graph
    output$test_graph <- renderPlot({
      if (req(selected_user()) != "All" && req(selected_user()) != "NULL") {
        plot(rnorm(30))
      }
    })

# Communication -----------------------------------------------------------

    # Variable : all of module's vars
    std_progression_vars <- reactiveValues()
    
    # Updating the vars
    # Nothing yet
    
    # Sending the vars
    return(std_progression_vars)    
    
  })
}
    
## To be copied in the UI
# mod_std_progression_ui("std_progression_1")
    
## To be copied in the server
# mod_std_progression_server("std_progression_1")
